<!DOCTYPE html>
<html lang="id">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Ujian Informatika - Soal Per Soal</title>
Â  Â  <style>
Â  Â  Â  Â  /* Modern Reset and Base Styles */
Â  Â  Â  Â  body {Â 
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;Â 
Â  Â  Â  Â  Â  Â  display: flex;Â 
Â  Â  Â  Â  Â  Â  justify-content: center;Â 
Â  Â  Â  Â  Â  Â  align-items: center;Â 
Â  Â  Â  Â  Â  Â  min-height: 100vh;Â 
Â  Â  Â  Â  Â  Â  background-color: #f0f4f8; /* Light blue/gray background */
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Container modern look */
Â  Â  Â  Â  .container {Â 
Â  Â  Â  Â  Â  Â  background-color: #ffffff;Â 
Â  Â  Â  Â  Â  Â  padding: 25px;Â 
Â  Â  Â  Â  Â  Â  border-radius: 12px;Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); /* Softer, deeper shadow */
Â  Â  Â  Â  Â  Â  width: 100%;Â 
Â  Â  Â  Â  Â  Â  max-width: 700px; /* Increased max width for better desktop view */
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  animation: fadeIn 0.8s ease-out;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Header Styling */
Â  Â  Â  Â  .header {Â 
Â  Â  Â  Â  Â  Â  text-align: center;Â 
Â  Â  Â  Â  Â  Â  margin-bottom: 30px;Â 
Â  Â  Â  Â  Â  Â  padding-bottom: 15px;
Â  Â  Â  Â  Â  Â  border-bottom: 2px solid #e0e0e0;
Â  Â  Â  Â  }
Â  Â  Â  Â  .header h2 {
Â  Â  Â  Â  Â  Â  color: #1a237e; /* Deep blue header color */
Â  Â  Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â  #status {
Â  Â  Â  Â  Â  Â  font-size: 0.9em;
Â  Â  Â  Â  Â  Â  color: #607d8b;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Question Area */
Â  Â  Â  Â  .question-area {Â 
Â  Â  Â  Â  Â  Â  min-height: 200px;Â 
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .question-area h4 {
Â  Â  Â  Â  Â  Â  color: #37474f; /* Dark text for question */
Â  Â  Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  line-height: 1.4;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Options (Pilihan Ganda) Modern Card Style */
Â  Â  Â  Â  .options label {Â 
Â  Â  Â  Â  Â  Â  display: flex; /* Use flexbox for alignment */
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin: 10px 0;Â 
Â  Â  Â  Â  Â  Â  padding: 15px;Â 
Â  Â  Â  Â  Â  Â  border: 1px solid #cfd8dc;Â 
Â  Â  Â  Â  Â  Â  border-radius: 8px;Â 
Â  Â  Â  Â  Â  Â  cursor: pointer;Â 
Â  Â  Â  Â  Â  Â  transition: all 0.2s ease; /* Smooth transition */
Â  Â  Â  Â  Â  Â  background-color: #fcfcfc;
Â  Â  Â  Â  }
Â  Â  Â  Â  .options label:hover {Â 
Â  Â  Â  Â  Â  Â  background-color: #e3f2fd; /* Light hover effect */
Â  Â  Â  Â  Â  Â  border-color: #90caf9;
Â  Â  Â  Â  }
Â  Â  Â  Â  .options input[type="radio"] {Â 
Â  Â  Â  Â  Â  Â  /* Hide default radio button */
Â  Â  Â  Â  Â  Â  position: absolute;Â 
Â  Â  Â  Â  Â  Â  opacity: 0;Â 
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* Custom radio button appearance */
Â  Â  Â  Â  .options input[type="radio"] + span::before {
Â  Â  Â  Â  Â  Â  content: '';
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  width: 18px;
Â  Â  Â  Â  Â  Â  height: 18px;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  border: 2px solid #90a4ae;
Â  Â  Â  Â  Â  Â  margin-right: 15px;
Â  Â  Â  Â  Â  Â  flex-shrink: 0;
Â  Â  Â  Â  Â  Â  transition: border-color 0.2s, background-color 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .options input[type="radio"]:checked + span::before {
Â  Â  Â  Â  Â  Â  background-color: #1a237e;
Â  Â  Â  Â  Â  Â  border-color: #1a237e;
Â  Â  Â  Â  }
Â  Â  Â  Â  .options input[type="radio"]:checked + span {Â 
Â  Â  Â  Â  Â  Â  font-weight: 600;Â 
Â  Â  Â  Â  Â  Â  color: #1a237e;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Input/Textarea Styling (Data Diri & Esai) */
Â  Â  Â  Â  input[type="text"], select, #essay-answer {
Â  Â  Â  Â  Â  Â  width: 100%;Â 
Â  Â  Â  Â  Â  Â  padding: 12px;Â 
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  border: 1px solid #ccc;Â 
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  }
Â  Â  Â  Â  #essay-answer {Â 
Â  Â  Â  Â  Â  Â  height: 120px;Â 
Â  Â  Â  Â  Â  Â  resize: vertical;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Navigation and Buttons */
Â  Â  Â  Â  .navigation {Â 
Â  Â  Â  Â  Â  Â  display: flex;Â 
Â  Â  Â  Â  Â  Â  justify-content: flex-end; /* Align button to the right */
Â  Â  Â  Â  Â  Â  margin-top: 30px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn {Â 
Â  Â  Â  Â  Â  Â  padding: 12px 30px; /* Larger padding for better mobile tap */
Â  Â  Â  Â  Â  Â  background-color: #3f51b5; /* Primary action color */
Â  Â  Â  Â  Â  Â  color: white;Â 
Â  Â  Â  Â  Â  Â  border: none;Â 
Â  Â  Â  Â  Â  Â  border-radius: 8px;Â 
Â  Â  Â  Â  Â  Â  cursor: pointer;Â 
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s, transform 0.1s;Â 
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn:hover:not(:disabled) {Â 
Â  Â  Â  Â  Â  Â  background-color: #303f9f;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn:disabled {Â 
Â  Â  Â  Â  Â  Â  background-color: #b0bec5;Â 
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Timer/Error Messages */
Â  Â  Â  Â  #timer-message {Â 
Â  Â  Â  Â  Â  Â  text-align: center;Â 
Â  Â  Â  Â  Â  Â  margin-top: 15px;Â 
Â  Â  Â  Â  Â  Â  font-size: 1.2em;Â 
Â  Â  Â  Â  Â  Â  color: #d32f2f; /* Darker red for urgency */
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  background-color: #ffcdd2;
Â  Â  Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  Â  }
Â  Â  Â  Â  .required-error {Â 
Â  Â  Â  Â  Â  Â  color: #d32f2f;Â 
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;Â 
Â  Â  Â  Â  Â  Â  font-weight: bold;Â 
Â  Â  Â  Â  Â  Â  display: none;Â 
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Animation Keyframes */
Â  Â  Â  Â  @keyframes fadeIn {
Â  Â  Â  Â  Â  Â  from { opacity: 0; transform: translateY(10px); }
Â  Â  Â  Â  Â  Â  to { opacity: 1; transform: translateY(0); }
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Responsiveness: Ensure stacking on small screens (mostly covered by max-width and padding) */
Â  Â  Â  Â  @media (max-width: 768px) {
Â  Â  Â  Â  Â  Â  body { padding: 10px; }
Â  Â  Â  Â  Â  Â  .container { padding: 20px; box-shadow: none; border-radius: 0; }
Â  Â  Â  Â  Â  Â  .btn { width: 100%; padding: 15px; } /* Full-width button on mobile */
Â  Â  Â  Â  Â  Â  .navigation { justify-content: center; }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

<div class="container">
Â  Â  <div class="header">
Â  Â  Â  Â  <h2>Ujian Informatika - Bab 1 & 2</h2>
Â  Â  Â  Â  <div id="status"></div>
Â  Â  </div>

Â  Â  <div class="question-area" id="quiz-content">
Â  Â  Â  Â  </div>

Â  Â  <div id="timer-message"></div>

Â  Â  <div class="navigation" id="quiz-navigation">
Â  Â  Â  Â  <button class="btn" id="next-btn" onclick="nextQuestion()" disabled>Mulai Ujian / Soal Berikutnya</button>
Â  Â  </div>
</div>

<script>
Â  Â  // âš ï¸ PASTIKAN URL WEB APP INI SUDAH DI-DEPLOY DENGAN AKSES 'Anyone'
Â  Â  const GOOGLE_SHEET_ENDPOINT = 'https://script.google.com/macros/s/AKfycbyS18HkhiX-Znaa2uRY58th51m5lFT2SMZHpsVPjHt34t04JtjIrohH2ZeaEA4beLZtjA/exec';Â 
Â  Â Â 
Â  Â  // --- Jeda Waktu Per Soal (10 detik) ---
Â  Â  const JEDA_WAKTU = 10;Â 

Â  Â  // --- Database Soal (Jawaban Benar di 'answer' (Indeks A=0, B=1, dst)) ---
Â  Â  const questions = [
Â  Â  Â  Â  // SOAL BAB 1 (Pilihan Ganda)
Â  Â  Â  Â  {Â 
Â  Â  Â  Â  Â  Â  type: 'mc',Â 
Â  Â  Â  Â  Â  Â  text: 'Metode pengujian reliabilitas data dalam rangka memperoleh data yang valid merupakan fase untuk . . . .',Â 
Â  Â  Â  Â  Â  Â  options: ['meningkatkan akurasi data', 'mengurangi sampel penelitian', 'menjamin data bebas dari bias', 'membandingkan data dengan teori', 'menentukan konsistensi pengukuran'],
Â  Â  Â  Â  Â  Â  answer: 4, // E
Â  Â  Â  Â  Â  Â  score: 5
Â  Â  Â  Â  },
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  type: 'mc',
Â  Â  Â  Â  Â  Â  text: 'Terkait potensi bias seleksi dalam analisis data, strategi yang tepat untuk memastikan sampel penelitian mewakili populasi adalah . . . .',
Â  Â  Â  Â  Â  Â  options: ['memilih subjek secara acak', 'memilih subjek yang paling aktif secara sosial', 'menggunakan subjek yang paling mudah diakses', 'memilih subjek berdasarkan ketersediaan mereka', 'memfokuskan pada subjek dengan karakteristik yang paling ekstrem'],
Â  Â  Â  Â  Â  Â  answer: 0, // A
Â  Â  Â  Â  Â  Â  score: 5
Â  Â  Â  Â  },
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  type: 'mc',
Â  Â  Â  Â  Â  Â  text: 'Ketika menggunakan bahasa pemrograman R, metode yang tepat untuk mendeteksi outliers dalam dataset adalah . . . .',
Â  Â  Â  Â  Â  Â  options: ['mengabaikan semua data yang tidak sesuai dengan ekspektasi', 'menggunakan mean sebagai satu-satunya metode analisis', 'menggunakan interquartile range', 'mengumpulkan lebih banyak data', 'menganalisis variansi data'],
Â  Â  Â  Â  Â  Â  answer: 2, // C
Â  Â  Â  Â  Â  Â  score: 5
Â  Â  Â  Â  },
Â  Â  Â  Â  // SOAL BAB 2 (Pilihan Ganda)
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  type: 'mc',
Â  Â  Â  Â  Â  Â  text: 'Saat menjalankan compiler Java dengan perintah command prompt, muncul pesan bahwa Java tidak dikenal. Tindakan yang harus dilakukan untuk mengatasi permasalahan tersebut adalah....',
Â  Â  Â  Â  Â  Â  options: ['menginstal ulang JDK', 'men-disable antivirus di Windows', 'menginstal web server di Windows', 'memperbaiki path environment', 'menginstal Java di Windows'],
Â  Â  Â  Â  Â  Â  answer: 3, // D
Â  Â  Â  Â  Â  Â  score: 5
Â  Â  Â  Â  },
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  type: 'mc',
Â  Â  Â  Â  Â  Â  text: 'Operator penugasan yang digunakan untuk membandingkan apakah dua data memiliki nilai yang sama adalah....',
Â  Â  Â  Â  Â  Â  options: ['<', '!=', '>', '==', '!'],
Â  Â  Â  Â  Â  Â  answer: 3, // D
Â  Â  Â  Â  Â  Â  score: 5
Â  Â  Â  Â  },
Â  Â  Â  Â  // SOAL ESAY
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  type: 'essay',
Â  Â  Â  Â  Â  Â  text: 'Jelaskan peran validitas eksternal dalam generalisasi data hasil penelitian.',
Â  Â  Â  Â  Â  Â  score: 10 // Poin untuk esai (penilaian manual)
Â  Â  Â  Â  }
Â  Â  ];

Â  Â  // --- Variabel Status Ujian ---
Â  Â  let currentQuestionIndex = -1;Â 
Â  Â  let studentData = {
Â  Â  Â  Â  name: '',
Â  Â  Â  Â  class: '',
Â  Â  Â  Â  answers: [],
Â  Â  Â  Â  totalScore: 0,
Â  Â  Â  Â  passingScore: 0
Â  Â  };
Â  Â  let timerInterval;

Â  Â  // --- Fungsi Utama Ujian ---

Â  Â  function startTimer() {
Â  Â  Â  Â  let timeLeft = JEDA_WAKTU;
Â  Â  Â  Â  const timerMsg = document.getElementById('timer-message');
Â  Â  Â  Â  const nextBtn = document.getElementById('next-btn');
Â  Â  Â  Â Â 
Â  Â  Â  Â  nextBtn.disabled = true;
Â  Â  Â  Â  nextBtn.textContent = `Tunggu ${timeLeft} detik...`;
Â  Â  Â  Â  timerMsg.textContent = `Jeda â³ Soal berikutnya akan muncul dalam ${timeLeft} detik. Cermati soal!`;


Â  Â  Â  Â  timerInterval = setInterval(() => {
Â  Â  Â  Â  Â  Â  timeLeft--;
Â  Â  Â  Â  Â  Â  if (timeLeft > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.textContent = `Tunggu ${timeLeft} detik...`;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  clearInterval(timerInterval);
Â  Â  Â  Â  Â  Â  Â  Â  timerMsg.textContent = 'Waktu Jeda Selesai. Silakan Jawab.';
Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.textContent = (currentQuestionIndex === questions.length - 1) ? 'Kirim Jawaban' : 'Soal Berikutnya';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, 1000);
Â  Â  }

Â  Â  function renderQuestion() {
Â  Â  Â  Â  const contentArea = document.getElementById('quiz-content');
Â  Â  Â  Â  const status = document.getElementById('status');
Â  Â  Â  Â  const nextBtn = document.getElementById('next-btn');

Â  Â  Â  Â  if (currentQuestionIndex < 0) {
Â  Â  Â  Â  Â  Â  // Tampilan Awal: Input Nama & Kelas
Â  Â  Â  Â  Â  Â  contentArea.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="required-error" id="data-error">Harap isi Nama Lengkap dan pilih Kelas Anda.</div>
Â  Â  Â  Â  Â  Â  Â  Â  <h3>Masukkan Data Diri</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <label for="student-name">Nama Lengkap:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="student-name" required>

Â  Â  Â  Â  Â  Â  Â  Â  <label for="student-class">Pilih Kelas:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="student-class" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">-- Pilih Kelas --</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="X DKV 1">X DKV 1</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="X DKV 2">X DKV 2</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="X APHP">X APHP</option>
Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  nextBtn.textContent = 'Mulai Ujian';
Â  Â  Â  Â  Â  Â  nextBtn.disabled = false;
Â  Â  Â  Â  Â  Â  status.textContent = 'Siap Memulai Ujian.';
Â  Â  Â  Â  Â  Â  document.getElementById('timer-message').textContent = '';
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  if (currentQuestionIndex < questions.length) {
Â  Â  Â  Â  Â  Â  // Tampilan Soal
Â  Â  Â  Â  Â  Â  const q = questions[currentQuestionIndex];
Â  Â  Â  Â  Â  Â  status.textContent = `Soal ${currentQuestionIndex + 1} dari ${questions.length}`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let htmlContent = `<h4>${currentQuestionIndex + 1}. ${q.text} (${q.score} Poin)</h4>`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (q.type === 'mc') {
Â  Â  Â  Â  Â  Â  Â  Â  // Pilihan Ganda
Â  Â  Â  Â  Â  Â  Â  Â  htmlContent += '<div class="options">';
Â  Â  Â  Â  Â  Â  Â  Â  q.options.forEach((opt, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const labelId = `q${currentQuestionIndex}-opt${i}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const letter = String.fromCharCode(65 + i);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  htmlContent += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="${labelId}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="radio" name="q${currentQuestionIndex}" id="${labelId}" value="${i}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>${letter}. ${opt}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  htmlContent += '</div>';
Â  Â  Â  Â  Â  Â  } else if (q.type === 'essay') {
Â  Â  Â  Â  Â  Â  Â  Â  // Esai
Â  Â  Â  Â  Â  Â  Â  Â  htmlContent += `<textarea id="essay-answer" placeholder="Tulis jawaban Anda di sini..."></textarea>`;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  contentArea.innerHTML = htmlContent;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Atur tombol 'Kirim Jawaban' jika ini soal terakhir
Â  Â  Â  Â  Â  Â  nextBtn.textContent = (currentQuestionIndex === questions.length - 1) ? 'Kirim Jawaban' : 'Soal Berikutnya';


Â  Â  Â  Â  Â  Â  // Jika ini bukan soal pertama (setelah data diri), aktifkan timer jeda
Â  Â  Â  Â  Â  Â  if (currentQuestionIndex > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  startTimer();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  nextBtn.disabled = false;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('timer-message').textContent = 'Selamat Mengerjakan!';
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  // Tampilan Selesai
Â  Â  Â  Â  Â  Â  finishQuiz();
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function checkAnswer() {
Â  Â  Â  Â  const q = questions[currentQuestionIndex];
Â  Â  Â  Â  let studentAnswer = null;
Â  Â  Â  Â  let isCorrect = false;
Â  Â  Â  Â  let scoreEarned = 0;

Â  Â  Â  Â  if (q.type === 'mc') {
Â  Â  Â  Â  Â  Â  const selectedOption = document.querySelector(`input[name="q${currentQuestionIndex}"]:checked`);
Â  Â  Â  Â  Â  Â  if (!selectedOption) return false;Â 

Â  Â  Â  Â  Â  Â  studentAnswer = parseInt(selectedOption.value);
Â  Â  Â  Â  Â  Â  isCorrect = (studentAnswer === q.answer);
Â  Â  Â  Â  Â  Â  scoreEarned = isCorrect ? q.score : 0;

Â  Â  Â  Â  Â  Â  studentData.passingScore += q.score;
Â  Â  Â  Â  } else if (q.type === 'essay') {
Â  Â  Â  Â  Â  Â  const essayText = document.getElementById('essay-answer').value.trim();
Â  Â  Â  Â  Â  Â  if (essayText === '') return false;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  studentAnswer = essayText;
Â  Â  Â  Â  Â  Â  scoreEarned = q.score;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  studentData.passingScore += q.score;
Â  Â  Â  Â  }

Â  Â  Â  Â  studentData.answers.push({
Â  Â  Â  Â  Â  Â  q_index: currentQuestionIndex,
Â  Â  Â  Â  Â  Â  q_type: q.type,
Â  Â  Â  Â  Â  Â  q_text: q.text.substring(0, 50) + '...',
Â  Â  Â  Â  Â  Â  student_answer: studentAnswer,
Â  Â  Â  Â  Â  Â  score_earned: scoreEarnedÂ 
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  studentData.totalScore += scoreEarned;Â 
Â  Â  Â  Â  return true;
Â  Â  }

Â  Â  function nextQuestion() {
Â  Â  Â  Â  if (currentQuestionIndex === -1) {
Â  Â  Â  Â  Â  Â  // Validasi Data Diri
Â  Â  Â  Â  Â  Â  const nameInput = document.getElementById('student-name').value.trim();
Â  Â  Â  Â  Â  Â  const classSelect = document.getElementById('student-class').value;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (nameInput === '' || classSelect === '') {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('data-error').style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  document.getElementById('data-error').style.display = 'none';
Â  Â  Â  Â  Â  Â  studentData.name = nameInput;
Â  Â  Â  Â  Â  Â  studentData.class = classSelect;
Â  Â  Â  Â  Â  Â  currentQuestionIndex++;
Â  Â  Â  Â  Â  Â  renderQuestion();
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Cek Jawaban Sebelum Lanjut atau Selesai
Â  Â  Â  Â  if (checkAnswer()) {
Â  Â  Â  Â  Â  Â  currentQuestionIndex++;
Â  Â  Â  Â  Â  Â  renderQuestion();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  alert('Harap jawab soal saat ini sebelum melanjutkan!');
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function finishQuiz() {
Â  Â  Â  Â  const contentArea = document.getElementById('quiz-content');
Â  Â  Â  Â  const navigation = document.getElementById('quiz-navigation');
Â  Â  Â  Â  const status = document.getElementById('status');
Â  Â  Â  Â Â 
Â  Â  Â  Â  contentArea.innerHTML = `
Â  Â  Â  Â  Â  Â  <h3>Ujian Selesai! ğŸ‰</h3>
Â  Â  Â  Â  Â  Â  <p>Terima kasih, <strong>${studentData.name}</strong> dari kelas <strong>${studentData.class}</strong>.</p>
Â  Â  Â  Â  Â  Â  <p>Jawaban Anda telah direkam dan dikirim.</p>
Â  Â  Â  Â  Â  Â  <p>Skor Pilihan Ganda (Otomatis): <strong>${studentData.totalScore} / ${studentData.passingScore - questions[questions.length-1].score}</strong></p>
Â  Â  Â  Â  Â  Â  <p style="color:#1a237e; font-weight:bold;">Tunggu nilai akhir Anda setelah Esai dinilai manual.</p>
Â  Â  Â  Â  `;
Â  Â  Â  Â  navigation.style.display = 'none';
Â  Â  Â  Â  status.textContent = 'Selesai';

Â  Â  Â  Â  // Kirim data ke Google Sheet
Â  Â  Â  Â  sendToGoogleSheet();
Â  Â  }

    // ğŸŒŸ PERBAIKAN PENTING ADA DI FUNGSI INI ğŸŒŸ
Â  Â  function sendToGoogleSheet() {
Â  Â  Â  Â  const dataToSend = {
Â  Â  Â  Â  Â  Â  timestamp: new Date().toLocaleString('id-ID'),
Â  Â  Â  Â  Â  Â  Nama_Lengkap: studentData.name,
Â  Â  Â  Â  Â  Â  Kelas: studentData.class,
Â  Â  Â  Â  Â  Â  Score_PG: studentData.totalScore,Â 
Â  Â  Â  Â  Â  Â  Score_Max: studentData.passingScore,Â 
Â  Â  Â  Â  Â  Â  Raw_Answers: JSON.stringify(studentData.answers.map(a => ({
Â  Â  Â  Â  Â  Â  Â  Â  q: a.q_text,Â 
Â  Â  Â  Â  Â  Â  Â  Â  ans: a.student_answer,Â 
Â  Â  Â  Â  Â  Â  Â  Â  type: a.q_type,
Â  Â  Â  Â  Â  Â  Â  Â  score: a.score_earned
Â  Â  Â  Â  Â  Â  })))
Â  Â  Â  Â  };

Â  Â  Â  Â  fetch(GOOGLE_SHEET_ENDPOINT, {
Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  mode: 'no-cors',Â 
Â  Â  Â  Â  Â  Â  cache: 'no-cache',
Â  Â  Â  Â  Â  Â  // Hapus atau jadikan komentar (COMMENT OUT) baris header JSON
            // Karena mode 'no-cors' tidak mengizinkan header JSON diatur
Â  Â  Â  Â  Â  Â  // headers: { 'Content-Type': 'application/json' }, 
Â  Â  Â  Â  Â  Â  body: JSON.stringify(dataToSend)
Â  Â  Â  Â  })
Â  Â  Â  Â  // Perbaikan di bagian .then() agar lebih realistis karena 'no-cors'
Â  Â  Â  Â  .then(() => console.log('Data telah dikirim ke Apps Script (Status tidak dapat dikonfirmasi karena no-cors).'))
Â  Â  Â  Â  .catch(error => console.error('Gagal mengirim data:', error));
Â  Â  }

Â  Â  document.addEventListener('DOMContentLoaded', renderQuestion);
</script>

</body>
</html>
