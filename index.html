// index.html (Fungsi sendToGoogleSheet yang sudah diperbaiki)

    function sendToGoogleSheet() {
        const dataToSend = {
            timestamp: new Date().toLocaleString('id-ID'),
            Nama_Lengkap: studentData.name,
            Kelas: studentData.class,
            Score_PG: studentData.totalScore, 
            Score_Max: studentData.passingScore, 
            Raw_Answers: JSON.stringify(studentData.answers.map(a => ({
                q: a.q_text, 
                ans: a.student_answer, 
                type: a.q_type,
                score: a.score_earned
            })))
        };

        fetch(GOOGLE_SHEET_ENDPOINT, {
            method: 'POST',
            mode: 'no-cors', 
            cache: 'no-cache',
            // Baris headers sudah dicomment out/dihapus. BAGUS!
            body: JSON.stringify(dataToSend)
        })
        .then(response => {
             // Karena mode 'no-cors', response.ok akan selalu false, 
             // tetapi fetch tetap berjalan sukses di sisi browser.
             console.log('Data telah dikirim ke Apps Script (Status tidak dapat dikonfirmasi karena no-cors).');
         })
        .catch(error => console.error('Gagal mengirim data:', error));
    }
